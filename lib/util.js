"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getPropertyType=exports.uriPattern=exports.propsPattern=exports.foldedLines=exports.blankLines=exports.whitespace=exports.atLinebreaks=exports.vcardPattern=exports.validateVersion=exports.getStatus=exports.makeJson=exports.trim=exports.capitalDashCase=void 0;var _types=require("./types");const capitalDashCase=str=>str.replace(/([A-Z])/g,"-$1").toUpperCase();const trim=(str,toRemove)=>str.split(toRemove).filter(Boolean).join(toRemove);const makeJson=value=>{try{return JSON.parse(value.toString())}catch(err){return value.toString()}};function getStatus(errs){if(errs.some(i=>i.isFatal))return"invalid";if(errs.length)return"malformed";return"valid"}function validateVersion(version){if(version==null||version==="")return[new _types.VcfFormatError(`Invalid vCard: expected "VERSION:*" but found "none"`,true),];if(!_types.VersionZod.safeParse(version).success)return[new _types.VcfVersionError(`Unsupported vCard: "VERSION:${version}" is not supported`,true),];return[]}const vcardPattern=/BEGIN:VCARD[\s\S]*?VERSION:(2\.1|3\.0|4\.0)[\s\S]*?END:VCARD/gi;const atLinebreaks=/\r|\n/g;const whitespace=/^[\s\r\n]+|[\s\r\n]+$/g;const blankLines=/(\r\n)[\x09\x20]?(\r\n)|$/g;const foldedLines=/\r\n[\x20\x09]/g;const propsPattern=/^([^;:]+)((?:;(?:[^;:]+))*)(?:\:([\s\S]+))?$/i;const uriPattern=/\w+:(\/?\/?)[^\s]+/gm;const timestampPattern=/^[0-9]{1,4}[-|\/|\.]?[0-9]{1,2}[-|\/|\.]?[0-9]{1,2}[T| ]?[0-9]{1,2}[:]?[0-9]{1,2}[:]?[0-9]{1,2}[Z]?$/;function getPropertyType(str){if(uriPattern.test(str))return"uri";if(timestampPattern.test(str))return"timestamp";return"text"}exports.capitalDashCase=capitalDashCase;exports.trim=trim;exports.makeJson=makeJson;exports.getStatus=getStatus;exports.validateVersion=validateVersion;exports.vcardPattern=vcardPattern;exports.atLinebreaks=atLinebreaks;exports.whitespace=whitespace;exports.blankLines=blankLines;exports.foldedLines=foldedLines;exports.propsPattern=propsPattern;exports.uriPattern=uriPattern;exports.getPropertyType=getPropertyType
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy91dGlsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIFZlcnNpb25ab2QsXG4gIFBhcnNlUmVzdWx0LFxuICBWY2ZGb3JtYXRFcnJvcixcbiAgVmNmVmVyc2lvbkVycm9yLFxufSBmcm9tIFwiLi90eXBlc1wiO1xuXG5jb25zdCBjYXBpdGFsRGFzaENhc2UgPSAoc3RyOiBzdHJpbmcpID0+XG4gIHN0ci5yZXBsYWNlKC8oW0EtWl0pL2csIFwiLSQxXCIpLnRvVXBwZXJDYXNlKCk7XG5cbi8qKlxuICogQGRlc2MgdXNlZCB0byByZW1vdmUgc3BlY2lmaWMgY2hhcmFjdGVycyBmcm9tIGJlZ2lubmluZyBhbmQgZW5kIG9mIHN0clxuICogQGV4YW1wbGUgdHJpbShcIisrbW9pbittZWlzdGVyK1wiLCBcIitcIikgPT4gXCIrbW9pbittZWlzdGVyXCJcbiAqL1xuY29uc3QgdHJpbSA9IChzdHI6IHN0cmluZywgdG9SZW1vdmU6IHN0cmluZykgPT5cbiAgc3RyLnNwbGl0KHRvUmVtb3ZlKS5maWx0ZXIoQm9vbGVhbikuam9pbih0b1JlbW92ZSk7XG5cbmNvbnN0IG1ha2VKc29uID0gKHZhbHVlOiBhbnkpID0+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZSh2YWx1ZS50b1N0cmluZygpKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCk7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGdldFN0YXR1cyhlcnJzOiBQYXJzZVJlc3VsdFtcImVycm9yc1wiXSk6IFBhcnNlUmVzdWx0W1wibWV0YVwiXVtcInN0YXR1c1wiXSB7XG4gIGlmIChlcnJzLnNvbWUoKGkpID0+IGkuaXNGYXRhbCkpIHJldHVybiBcImludmFsaWRcIjtcblxuICBpZiAoZXJycy5sZW5ndGgpIHJldHVybiBcIm1hbGZvcm1lZFwiO1xuXG4gIHJldHVybiBcInZhbGlkXCI7XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlVmVyc2lvbih2ZXJzaW9uOiBzdHJpbmcpOiBQYXJzZVJlc3VsdFtcImVycm9yc1wiXSB7XG4gIGlmICh2ZXJzaW9uID09IG51bGwgfHwgdmVyc2lvbiA9PT0gXCJcIilcbiAgICByZXR1cm4gW1xuICAgICAgbmV3IFZjZkZvcm1hdEVycm9yKFxuICAgICAgICBgSW52YWxpZCB2Q2FyZDogZXhwZWN0ZWQgXCJWRVJTSU9OOipcIiBidXQgZm91bmQgXCJub25lXCJgLFxuICAgICAgICB0cnVlXG4gICAgICApLFxuICAgIF07XG5cbiAgaWYgKCFWZXJzaW9uWm9kLnNhZmVQYXJzZSh2ZXJzaW9uKS5zdWNjZXNzKVxuICAgIHJldHVybiBbXG4gICAgICBuZXcgVmNmVmVyc2lvbkVycm9yKFxuICAgICAgICBgVW5zdXBwb3J0ZWQgdkNhcmQ6IFwiVkVSU0lPTjoke3ZlcnNpb259XCIgaXMgbm90IHN1cHBvcnRlZGAsXG4gICAgICAgIHRydWVcbiAgICAgICksXG4gICAgXTtcbiAgcmV0dXJuIFtdO1xufVxuXG4vKiBibGFjayBtYWdpYyBzZWN0aW9uICovXG5cbmNvbnN0IHZjYXJkUGF0dGVybiA9XG4gIC9CRUdJTjpWQ0FSRFtcXHNcXFNdKj9WRVJTSU9OOigyXFwuMXwzXFwuMHw0XFwuMClbXFxzXFxTXSo/RU5EOlZDQVJEL2dpO1xuXG5jb25zdCBhdExpbmVicmVha3MgPSAvXFxyfFxcbi9nO1xuY29uc3Qgd2hpdGVzcGFjZSA9IC9eW1xcc1xcclxcbl0rfFtcXHNcXHJcXG5dKyQvZztcbmNvbnN0IGJsYW5rTGluZXMgPSAvKFxcclxcbilbXFx4MDlcXHgyMF0/KFxcclxcbil8JC9nO1xuY29uc3QgZm9sZGVkTGluZXMgPSAvXFxyXFxuW1xceDIwXFx4MDldL2c7XG5jb25zdCBwcm9wc1BhdHRlcm4gPSAvXihbXjs6XSspKCg/OjsoPzpbXjs6XSspKSopKD86XFw6KFtcXHNcXFNdKykpPyQvaTtcbmNvbnN0IHVyaVBhdHRlcm4gPSAvXFx3KzooXFwvP1xcLz8pW15cXHNdKy9nbTtcbmNvbnN0IHRpbWVzdGFtcFBhdHRlcm4gPVxuICAvXlswLTldezEsNH1bLXxcXC98XFwuXT9bMC05XXsxLDJ9Wy18XFwvfFxcLl0/WzAtOV17MSwyfVtUfCBdP1swLTldezEsMn1bOl0/WzAtOV17MSwyfVs6XT9bMC05XXsxLDJ9W1pdPyQvO1xuXG5mdW5jdGlvbiBnZXRQcm9wZXJ0eVR5cGUoc3RyOiBhbnkpIHtcbiAgaWYgKHVyaVBhdHRlcm4udGVzdChzdHIpKSByZXR1cm4gXCJ1cmlcIjtcblxuICBpZiAodGltZXN0YW1wUGF0dGVybi50ZXN0KHN0cikpIHJldHVybiBcInRpbWVzdGFtcFwiO1xuXG4gIHJldHVybiBcInRleHRcIjtcbn1cblxuZXhwb3J0IHtcbiAgY2FwaXRhbERhc2hDYXNlLFxuICB0cmltLFxuICBtYWtlSnNvbixcbiAgZ2V0U3RhdHVzLFxuICB2YWxpZGF0ZVZlcnNpb24sXG4gIHZjYXJkUGF0dGVybixcbiAgYXRMaW5lYnJlYWtzLFxuICB3aGl0ZXNwYWNlLFxuICBibGFua0xpbmVzLFxuICBmb2xkZWRMaW5lcyxcbiAgcHJvcHNQYXR0ZXJuLFxuICB1cmlQYXR0ZXJuLFxuICBnZXRQcm9wZXJ0eVR5cGUsXG59O1xuIl0sIm5hbWVzIjpbImNhcGl0YWxEYXNoQ2FzZSIsInN0ciIsInJlcGxhY2UiLCJ0b1VwcGVyQ2FzZSIsInRyaW0iLCJ0b1JlbW92ZSIsInNwbGl0IiwiZmlsdGVyIiwiQm9vbGVhbiIsImpvaW4iLCJtYWtlSnNvbiIsInZhbHVlIiwiSlNPTiIsInBhcnNlIiwidG9TdHJpbmciLCJlcnIiLCJnZXRTdGF0dXMiLCJlcnJzIiwic29tZSIsImkiLCJpc0ZhdGFsIiwibGVuZ3RoIiwidmFsaWRhdGVWZXJzaW9uIiwidmVyc2lvbiIsIlZjZkZvcm1hdEVycm9yIiwiVmVyc2lvblpvZCIsInNhZmVQYXJzZSIsInN1Y2Nlc3MiLCJWY2ZWZXJzaW9uRXJyb3IiLCJ2Y2FyZFBhdHRlcm4iLCJhdExpbmVicmVha3MiLCJ3aGl0ZXNwYWNlIiwiYmxhbmtMaW5lcyIsImZvbGRlZExpbmVzIiwicHJvcHNQYXR0ZXJuIiwidXJpUGF0dGVybiIsInRpbWVzdGFtcFBhdHRlcm4iLCJnZXRQcm9wZXJ0eVR5cGUiLCJ0ZXN0Il0sIm1hcHBpbmdzIjoiQUFBQSxnVkFLTyxLQUFBLE1BQVMsU0FBVCxTQUFTLENBQUEsQUFFaEIsT0FBTUEsZUFBZSxDQUFHLEFBQUNDLEdBQVcsRUFDbENBLEdBQUcsQ0FBQ0MsT0FBTyxZQUFhLEtBQUssQ0FBQyxDQUFDQyxXQUFXLEVBQUUsQUFBQyxBQU0vQyxPQUFNQyxJQUFJLENBQUcsQ0FBQ0gsR0FBVyxDQUFFSSxRQUFnQixHQUN6Q0osR0FBRyxDQUFDSyxLQUFLLENBQUNELFFBQVEsQ0FBQyxDQUFDRSxNQUFNLENBQUNDLE9BQU8sQ0FBQyxDQUFDQyxJQUFJLENBQUNKLFFBQVEsQ0FBQyxBQUFDLEFBRXJELE9BQU1LLFFBQVEsQ0FBRyxBQUFDQyxLQUFVLEVBQUssQ0FDL0IsR0FBSSxDQUNGLE9BQU9DLElBQUksQ0FBQ0MsS0FBSyxDQUFDRixLQUFLLENBQUNHLFFBQVEsRUFBRSxDQUFDLEFBQUMsQ0FDckMsQUFBQyxNQUFPQyxHQUFHLENBQUUsQ0FDWixPQUFPSixLQUFLLENBQUNHLFFBQVEsRUFBRSxBQUFDLENBQ3pCLENBQ0YsQUFBQyxBQUVGLFVBQVNFLFNBQVMsQ0FBQ0MsSUFBMkIsQ0FBaUMsQ0FDN0UsR0FBSUEsSUFBSSxDQUFDQyxJQUFJLENBQUMsQUFBQ0MsQ0FBQyxFQUFLQSxDQUFDLENBQUNDLE9BQU8sQ0FBQyxDQUFFLE1BQU8sU0FBUyxBQUFDLEFBRWxELElBQUlILElBQUksQ0FBQ0ksTUFBTSxDQUFFLE1BQU8sV0FBVyxBQUFDLEFBRXBDLE9BQU8sT0FBTyxBQUFDLENBQ2hCLEFBRUQsU0FBU0MsZUFBZSxDQUFDQyxPQUFlLENBQXlCLENBQy9ELEdBQUlBLE9BQU8sRUFBSSxJQUFJLEVBQUlBLE9BQU8sR0FBSyxFQUFFLENBQ25DLE1BQU8sQ0FDTCxJQUFJQyxNQUFjLGVBQUEsQ0FDaEIsQ0FBQyxvREFBb0QsQ0FBQyxDQUN0RCxJQUFJLENBQ0wsRUFDRixBQUFDLEFBRUosSUFBSSxDQUFDQyxNQUFVLFdBQUEsQ0FBQ0MsU0FBUyxDQUFDSCxPQUFPLENBQUMsQ0FBQ0ksT0FBTyxDQUN4QyxNQUFPLENBQ0wsSUFBSUMsTUFBZSxnQkFBQSxDQUNqQixDQUFDLDRCQUE0QixFQUFFTCxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FDMUQsSUFBSSxDQUNMLEVBQ0YsQUFBQyxBQUNKLE9BQU8sRUFBRSxBQUFDLENBQ1gsQUFJRCxNQUFNTSxZQUFZLGlFQUNnRCxBQUFDLEFBRW5FLE9BQU1DLFlBQVksU0FBVyxBQUFDLEFBQzlCLE9BQU1DLFVBQVUseUJBQTJCLEFBQUMsQUFDNUMsT0FBTUMsVUFBVSw2QkFBK0IsQUFBQyxBQUNoRCxPQUFNQyxXQUFXLGtCQUFvQixBQUFDLEFBQ3RDLE9BQU1DLFlBQVksZ0RBQWtELEFBQUMsQUFDckUsT0FBTUMsVUFBVSx1QkFBeUIsQUFBQyxBQUMxQyxPQUFNQyxnQkFBZ0IsdUdBQ2tGLEFBQUMsQUFFekcsVUFBU0MsZUFBZSxDQUFDcEMsR0FBUSxDQUFFLENBQ2pDLEdBQUlrQyxVQUFVLENBQUNHLElBQUksQ0FBQ3JDLEdBQUcsQ0FBQyxDQUFFLE1BQU8sS0FBSyxBQUFDLEFBRXZDLElBQUltQyxnQkFBZ0IsQ0FBQ0UsSUFBSSxDQUFDckMsR0FBRyxDQUFDLENBQUUsTUFBTyxXQUFXLEFBQUMsQUFFbkQsT0FBTyxNQUFNLEFBQUMsQ0FDZixRQUdDRCxlQUFlLENBQWZBLGVBQWUsU0FDZkksSUFBSSxDQUFKQSxJQUFJLFNBQ0pNLFFBQVEsQ0FBUkEsUUFBUSxTQUNSTSxTQUFTLENBQVRBLFNBQVMsU0FDVE0sZUFBZSxDQUFmQSxlQUFlLFNBQ2ZPLFlBQVksQ0FBWkEsWUFBWSxTQUNaQyxZQUFZLENBQVpBLFlBQVksU0FDWkMsVUFBVSxDQUFWQSxVQUFVLFNBQ1ZDLFVBQVUsQ0FBVkEsVUFBVSxTQUNWQyxXQUFXLENBQVhBLFdBQVcsU0FDWEMsWUFBWSxDQUFaQSxZQUFZLFNBQ1pDLFVBQVUsQ0FBVkEsVUFBVSxTQUNWRSxlQUFlLENBQWZBLGVBQWUsQUFDZiJ9